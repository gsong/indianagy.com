---
import "@fontsource-variable/work-sans";
import "@fontsource/alice";
import { Mail } from "lucide-react";
import { Phone } from "lucide-react";

import "@/styles/global.css";

import Head from "@/components/Head.astro";

const BASE_URL = import.meta.env.BASE_URL;
---

<!doctype html>
<html lang="en">
  <Head />

  <body>
    <header
      id="header"
      class="fixed left-0 top-0 z-50 w-full bg-white bg-opacity-80 py-2 shadow-lg backdrop-blur-md backdrop-filter md:py-12"
    >
      <nav
        class="site-width flex items-baseline justify-between"
        aria-label="primary navigation"
      >
        <a
          href={BASE_URL}
          class="font-serif text-2xl hover:no-underline md:text-3xl"
          >India Nagy</a
        >
        <ul class="flex gap-x-3.5">
          <li>
            <a href={BASE_URL}>Work</a>
          </li>
          <li>
            <a href={`${BASE_URL}about`}>About</a>
          </li>
          <li>
            <a href={`${BASE_URL}contact`}>Contact</a>
          </li>
        </ul>
      </nav>
    </header>

    <main id="main" class="site-width mt-6 pt-[48px] sm:mt-8 md:pt-[132px]">
      <slot />
    </main>

    <footer class="mt-6 bg-secondary py-2">
      <div class="site-width my-4 space-y-4">
        <a
          href="mailto:hello@indianagy.com"
          class="flex w-fit items-center gap-2"
          rel="nofollow"
        >
          <Mail size="18" />
          <div>hello@indianagy.com</div>
        </a>
        <a
          href="tel:+12063835468"
          aria-label="Call India at 206-383-5468"
          class="flex w-fit items-center gap-2"
          rel="nofollow"
        >
          <Phone size="18" />
          <div>(260) 383-5468</div>
        </a>
        <p class="text-sm text-muted-foreground">
          Â© 2025 India Nagy. All rights reserved.
        </p>
      </div>
    </footer>
  </body>
</html>

<script>
  const header = document.getElementById("header")!;
  const main = document.getElementById("main")!;
  const DELAY = 300 * 1.1;

  let mainPadding = 0;

  function updateHeaderHeight() {
    const scrollTop = document.documentElement.scrollTop;

    if (scrollTop > 50) {
      header.classList.remove("md:py-12");
    } else {
      header.classList.add("md:py-12");
    }
  }

  function updateMainPadding() {
    const height = header.offsetHeight;
    if (height === mainPadding) return;
    mainPadding = height;
    main.style.paddingTop = `${mainPadding}px`;
  }

  function setMainPaddingTop() {
    const viewportWidth = window.innerWidth;

    if (viewportWidth < 768) {
      mainPadding = 48;
    } else {
      mainPadding = 132;
    }
    main.style.paddingTop = `${mainPadding}px`;
  }

  document.addEventListener("DOMContentLoaded", () => {
    setMainPaddingTop();
  });

  window.addEventListener("load", () => {
    setTimeout(() => {
      updateMainPadding();

      header.classList.add(
        "transition-[padding]",
        "duration-300",
        "ease-in-out",
      );
    }, DELAY);

    window.addEventListener("scroll", updateHeaderHeight);
    window.addEventListener("resize", updateHeaderHeight);

    const observer = new MutationObserver((mutations) => {
      mutations.forEach(({ type, attributeName }) => {
        if (type === "attributes" && attributeName === "class") {
          setTimeout(updateMainPadding, DELAY);
        }
      });
    });

    observer.observe(header, {
      attributes: true,
      attributeFilter: ["class"],
    });
  });
</script>
